# Кейс 2

* auto-gen TOC:
{:toc}

## Ситуация заказчика
Большинство решений клиента развернуто на виртуальных машинах и `bare metal` серверах. Проблемы с
масштабированием, так как преобладают монолитные продукты. Есть потребность в ускорении старта процесса разработки, минуя медленное ИТ.

## Цель
Обеспечить быстрый старт командам разработки. Свести к минимуму количество необходимых ИТ услуг. Упростить переход на
микросервисную архитектуру. Автоматизировать процесс сборки, доставки артефактов и деплоя приложений.

## Подробный кейс и результаты работы

```admonish info
Используемый стек технологий: Kubernetes, Gitlab, Helm, Docker, Nexus, Consul, cert-manager, Vault, Keycloak, Ceph, Terraform, Ansible.
```

### Решение
Реализован переход на контейнерную технологию и внедрен `CI/CD`:

-   Развернут open source кластер `Kubernetes` на `bare metal` серверах.

-   Создано внутрикорпоративное хранилище артефактов на основе `Nexus` и
    описаны процессы создания образов

-   На основе `Nexus` реализован прокси доступ к ресурсам в Интернет

-   `CI/CD` и хранение кода реализовано на `Gitlab`

-   Реализовано хранение секретов в `Vault` с целью автоматизации `CD`
    процессов

-   Автоматизация выпуска сертификатов реализована на `PKI Vault` с
    помощью `cert-manager`

-   Для авторизации сервисов и пользователей развернут `Keycloak`.
    Настроена интеграция `Keycloak` с централизованным AD с одной стороны
    и со всеми сервисами платформы - `Kubernetes`, `Vault`, `Gitlab` итд с
    другой.

-   Создан Web портал для новой платформы

-   В качестве persistent для платформы оркестрации сервисов развернут
    `Ceph`

-   Для хранения резервных данных, `Terraform states`, промежуточных
    данных `CI/CD` итд создан `S3` на `RadosGW Ceph`

### Результат
Созданная экосистема решила задачи Клиента:

-   Использование платформы, построенной на `Kubernetes`, упростило задачу
    перехода на микросервисную топологию и позволило командам получать
    сервисы как услугу.

-   `Giltab` централизовал в компании место хранения кода и реализовал
    процессы сборки и доставки артефактов, а также деплоя приложений,
    что ускорило и упростило процесс разработки приложений. Сократилось
    время сборки проектов в два раза, за счет применения динамических
    процессов для сборки, использования кэша хранилища артефактов.

-   `Cert-manager` снял проблему долгого выпуска сертификатов в ИТ,
    контроля срока действия, безопасности. Наладил процесс
    автоматического перевыпуска короткоживущих сертификатов. Перевыпуск
    сертификата с помощью `сert-manager` занял минуты вместо дней
    офрмления нового сертификата через заявку в ИТ.

-   С помощью `Keycloak` удалось решить проблему долгой настройки
    авторизации. Предварительное создание ролевых технологических AD
    групп для каждой команды и каждой системы позволило упростить
    получение доступа разработчикам, владельцем продукта, аудиторам итд

-   У команд отпала потребность заказывать доступ в Интернет, так как
    все необходимые артефакты можно получить с помощью Nexus. Это
    сэкономило несколько дней заказчику.
